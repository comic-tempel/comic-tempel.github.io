import{d as P,n as B,o as m,x as E,a,w as t,u as e,k as b,a7 as I,j as f,a3 as k,a8 as S,a9 as A,a2 as C,b as r,t as D,J as L,c as x,aa as O,F as R,f as K,y as T,m as F,Y as Q,l as q,N as W,ab as z,ac as J,M as Y,z as X,ad as Z,ae as ee,af as ae,ag as te,ah as se,ai as oe,aj as G,ak as ne,G as $,al as ie,$ as le,a0 as re}from"./index.c4984c2c.js";import{u as M,t as U,o as H,e as j,p as V,a as N}from"./validation.b252412e.js";import{t as de}from"./ui.c5a29218.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";import{c as ce,u as me}from"./useMachine.8ad8092e.js";var fe="/assets/header.d375a6b9.jpg";const pe=r("E-Mail Adresse"),ge=r("Passwort"),_e=r("anmelden"),ye=P({props:{email:{default:void 0},password:{default:void 0},isBusy:{type:Boolean,default:!1}},emits:["submit"],setup(o,{expose:p,emit:g}){const _=o,{handleSubmit:y,errors:d,meta:h,resetForm:w}=M({validationSchema:U(H({email:j,password:V}))}),{value:l}=N("email"),{value:u}=N("password"),i=y(s=>g("submit",s));return B(()=>l.value=_.email),B(()=>u.value=_.password),p({reset:w}),(s,n)=>(m(),E(R,null,[a(e(L),{class:"m-0",lines:"full"},{default:t(()=>[a(e(b),{class:I({"ion-invalid":e(d).email})},{default:t(()=>[a(e(f),{position:"floating"},{default:t(()=>[pe]),_:1}),a(e(k),{modelValue:e(l),"onUpdate:modelValue":n[0]||(n[0]=c=>S(l)?l.value=c:null),name:"email",type:"email",autocomplete:"email",inputmode:"email",required:"true",enterkeyhint:"next",autofocus:!0,disabled:o.isBusy,onKeyup:A(e(i),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(C),{slot:"error"},{default:t(()=>[r(D(e(d).email),1)]),_:1})]),_:1},8,["class"]),a(e(b),{class:I({"ion-invalid":e(d).password})},{default:t(()=>[a(e(f),{position:"floating"},{default:t(()=>[ge]),_:1}),a(e(k),{modelValue:e(u),"onUpdate:modelValue":n[1]||(n[1]=c=>S(u)?u.value=c:null),name:"password",type:"password",required:"true",enterkeyhint:"send",disabled:o.isBusy,onKeyup:A(e(i),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(C),{slot:"error"},{default:t(()=>[r(D(e(d).password),1)]),_:1})]),_:1},8,["class"])]),_:1}),a(e(K),{class:"mt-5",expand:"full",disabled:!e(h).valid||o.isBusy,onClick:e(i)},{default:t(()=>[o.isBusy?(m(),x(e(O),{key:0,slot:"icon-only"})):(m(),E(R,{key:1},[_e],64))]),_:1},8,["disabled","onClick"])],64))}}),he={key:0,class:"text-center"},we=T("div",{class:"text-5xl py-8 block"},"\u{1F389}",-1),ve=T("div",{class:"block"},"Du hast Dich erfolgreich angemeldet! Bitte \xF6ffne Dein Postfach und klick auf den Best\xE4tigungslink in unserer Nachricht.",-1),Ee=[we,ve],be=r("E-Mail Adresse"),Ie=r("sicheres Passwort"),ke=r("Passwort wiederholen"),Se=r("ich bin dabei!"),Ae=P({props:{email:{default:void 0},isBusy:{type:Boolean,default:!1},isDone:{type:Boolean,default:!1}},emits:["submit"],setup(o,{expose:p,emit:g}){const _=o,{handleSubmit:y,errors:d,meta:h,resetForm:w}=M({validationSchema:U(H({email:j,password:V,confirmation:V.nonempty("Bitte wiederhole das Passwort")}).refine(n=>n.password==n.confirmation,{message:"Die Passw\xF6rter stimmen nicht \xFCberein",path:["confirmation"]}))}),{value:l}=N("email"),{value:u}=N("password"),{value:i}=N("confirmation"),s=y(n=>g("submit",n));return B(()=>l.value=_.email),p({reset:w}),(n,c)=>o.isDone?(m(),E("div",he,Ee)):(m(),E(R,{key:1},[a(e(L),{class:"m-0",lines:"full"},{default:t(()=>[a(e(b),{class:I({"ion-invalid":e(d).email})},{default:t(()=>[a(e(f),{position:"floating"},{default:t(()=>[be]),_:1}),a(e(k),{modelValue:e(l),"onUpdate:modelValue":c[0]||(c[0]=v=>S(l)?l.value=v:null),name:"email",type:"email",autocomplete:"email",inputmode:"email",required:"true",enterkeyhint:"next",autofocus:!0,disabled:o.isBusy,onKeyup:A(e(s),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(C),{slot:"error"},{default:t(()=>[r(D(e(d).email),1)]),_:1})]),_:1},8,["class"]),a(e(b),{class:I({"ion-invalid":e(d).password})},{default:t(()=>[a(e(f),{position:"floating"},{default:t(()=>[Ie]),_:1}),a(e(k),{modelValue:e(u),"onUpdate:modelValue":c[1]||(c[1]=v=>S(u)?u.value=v:null),name:"password",type:"password",required:"true",enterkeyhint:"send",disabled:o.isBusy,onKeyup:A(e(s),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(C),{slot:"error"},{default:t(()=>[r(D(e(d).password),1)]),_:1})]),_:1},8,["class"]),a(e(b),{class:I({"ion-invalid":e(d).confirmation})},{default:t(()=>[a(e(f),{position:"floating"},{default:t(()=>[ke]),_:1}),a(e(k),{modelValue:e(i),"onUpdate:modelValue":c[2]||(c[2]=v=>S(i)?i.value=v:null),name:"confirmation",type:"password",required:"true",enterkeyhint:"send",disabled:o.isBusy,onKeyup:A(e(s),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(C),{slot:"error"},{default:t(()=>[r(D(e(d).confirmation),1)]),_:1})]),_:1},8,["class"])]),_:1}),a(e(K),{class:"mt-5",expand:"full",disabled:!e(h).valid||o.isBusy,onClick:e(s)},{default:t(()=>[o.isBusy?(m(),x(e(O),{key:0,slot:"icon-only"})):(m(),E(R,{key:1},[Se],64))]),_:1},8,["disabled","onClick"])],64))}});const Ce=o=>(le("data-v-6e16c04b"),o=o(),re(),o),De=Ce(()=>T("img",{class:"w-full",src:fe,alt:"Manga Wiki Kopzeile"},null,-1)),xe=r("Manga Wiki"),Ne=r("Anmeldung"),Re=r("Neu hier?"),Be=P({setup(o){const p=F(null),g=F(null),{login:_,register:y,currentSession:d}=Q(),{replace:h}=q(),w=ce({id:"Auth",initial:"Login",schema:{events:{}},on:{SESSION_CHANGED:{cond:"isAuthenticated",target:"Login.Authenticated"}},states:{Login:{initial:"AwaitingCredentials",on:{MODE_CHANGED:"Registration"},states:{AwaitingCredentials:{on:{LOGIN_REQUESTED:{target:"Processing"}}},Processing:{invoke:{src:"login",onDone:"Authenticated",onError:{actions:"showError",target:"AwaitingCredentials"}}},Authenticated:{type:"final",entry:"enterWiki"}}},Registration:{initial:"AwaitingCredentials",on:{MODE_CHANGED:"Login"},states:{AwaitingCredentials:{on:{REGISTRATION_REQUESTED:{target:"Processing"}}},Processing:{invoke:{src:"register",onDone:"Registered",onError:{actions:"showError",target:"AwaitingCredentials"}}},Registered:{type:"final"}}}}},{actions:{showError:(i,s)=>{var n;return de({message:(n=s.data)!=null?n:"Das hat leider nicht geklappt...",color:"danger"})},enterWiki:()=>h({name:"MangaListPage"})},services:{login:(i,s)=>s.type==="LOGIN_REQUESTED"?_(s):Promise.reject(),register:(i,s)=>s.type==="REGISTRATION_REQUESTED"?y(s):Promise.reject()},guards:{isAuthenticated:(i,s)=>s.type==="SESSION_CHANGED"?s.isAuthenticated:!1}}),{state:l,send:u}=me(w,{devTools:!1});return W(()=>d,i=>u("SESSION_CHANGED",{isAuthenticated:i!=null})),z(()=>u("SESSION_CHANGED",{isAuthenticated:d.value!=null})),J(()=>{var i,s;(i=p.value)==null||i.reset(),(s=g.value)==null||s.reset()}),(i,s)=>(m(),x(e(Y),null,{default:t(()=>[a(e(X),null,{default:t(()=>[a(e(ie),{class:"h-full"},{default:t(()=>[a(e(Z),{class:"h-full"},{default:t(()=>[a(e(ee),{class:"align-top md:flex md:align-middle"},{default:t(()=>[a(e(ae),{class:"rounded-none shadow-none m-auto w-full md:w-96 md:rounded-xl md:shadow-xl"},{default:t(()=>[De,a(e(te),null,{default:t(()=>[a(e(se),null,{default:t(()=>[xe]),_:1}),a(e(oe),{class:"mt-4",value:"login",onIonChange:s[0]||(s[0]=n=>e(u)("MODE_CHANGED"))},{default:t(()=>[a(e(G),{value:"login"},{default:t(()=>[a(e(f),null,{default:t(()=>[Ne]),_:1})]),_:1}),a(e(G),{value:"registration"},{default:t(()=>[a(e(f),null,{default:t(()=>[Re]),_:1})]),_:1})]),_:1})]),_:1}),a(e(ne),null,{default:t(()=>[e(l).matches("Login")?(m(),x(ye,{key:0,ref_key:"loginForm",ref:p,"is-busy":e(l).matches("Login.Processing"),onSubmit:s[1]||(s[1]=n=>e(u)("LOGIN_REQUESTED",n))},null,8,["is-busy"])):$("",!0),e(l).matches("Registration")?(m(),x(Ae,{key:1,ref_key:"registrationForm",ref:g,"is-busy":e(l).matches("Registration.Processing"),"is-done":e(l).matches("Registration.Registered"),onSubmit:s[2]||(s[2]=n=>e(u)("REGISTRATION_REQUESTED",n))},null,8,["is-busy","is-done"])):$("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});var $e=ue(Be,[["__scopeId","data-v-6e16c04b"]]);export{$e as default};
