import{d as D,w as v,o as f,a as h,b as t,e,u as a,ah as S,ai as V,aj as F,J as N,E as C,ak as E,D as b,ac as A,al as k,ab as y,s as o,v as L,y as G,am as M,K as O,an as P,ao as R,a4 as T,M as U,r as B,a5 as W,F as j,a3 as q,ap as Q,Q as $,P as z,aq as K,ar as H,as as J}from"./vendor.801380ed.js";import{u as X,t as Y,o as Z,e as aa,p as ea,a as x}from"./validation.0b62e0f4.js";import{a as ta}from"./index.e7ab0164.js";import{t as sa}from"./ui.0d1e7409.js";import{_ as la}from"./plugin-vue_export-helper.21dcd24c.js";import{u as oa}from"./useMachine.bd75bb26.js";var na="/assets/header.d375a6b9.jpg";const ia=T("img",{class:"w-full",src:na,alt:"Manga Wiki Kopzeile"},null,-1),da=o("Manga Wiki"),ra=o("Anmeldung "),ua=o("E-Mail Adresse"),ma=o("Passwort"),ca=o("anmelden"),fa=D({props:{email:{default:void 0},password:{default:void 0},state:{default:"AwaitingCredentials"}},emits:["submit"],setup(n,{expose:r,emit:_}){const u=n,{handleSubmit:p,errors:i,meta:d,resetForm:g}=X({validationSchema:Y(Z({email:aa,password:ea}))}),{value:s}=x("email"),{value:l}=x("password"),m=p(w=>_("submit",{email:w.email,password:w.password}));return v(()=>s.value=u.email),v(()=>l.value=u.password),r({clear:g}),(w,c)=>(f(),h(a(R),{class:"rounded-none shadow-none m-auto w-full md:w-96 md:rounded-xl md:shadow-xl"},{default:t(()=>[ia,e(a(F),null,{default:t(()=>[e(a(S),null,{default:t(()=>[da]),_:1}),e(a(V),null,{default:t(()=>[ra]),_:1})]),_:1}),e(a(P),null,{default:t(()=>[e(a(N),{class:"m-0",lines:"full"},{default:t(()=>[e(a(C),{class:E({"ion-invalid":a(i).email})},{default:t(()=>[e(a(b),{position:"floating"},{default:t(()=>[ua]),_:1}),e(a(A),{modelValue:a(s),"onUpdate:modelValue":c[0]||(c[0]=I=>k(s)?s.value=I:null),name:"email",type:"email",autocomplete:"email",inputmode:"email",required:"true",enterkeyhint:"next",autofocus:!0,disabled:n.state=="Authenticating"},null,8,["modelValue","disabled"]),e(a(y),{slot:"error"},{default:t(()=>[o(L(a(i).email),1)]),_:1})]),_:1},8,["class"]),e(a(C),{class:E({"ion-invalid":a(i).password})},{default:t(()=>[e(a(b),{position:"floating"},{default:t(()=>[ma]),_:1}),e(a(A),{modelValue:a(l),"onUpdate:modelValue":c[1]||(c[1]=I=>k(l)?l.value=I:null),name:"password",type:"password",required:"true",enterkeyhint:"send",disabled:n.state=="Authenticating"},null,8,["modelValue","disabled"]),e(a(y),{slot:"error"},{default:t(()=>[o(L(a(i).password),1)]),_:1})]),_:1},8,["class"])]),_:1}),e(a(G),{class:"mt-5",expand:"full",disabled:!a(d).valid||n.state=="Authenticating",onClick:a(m)},{default:t(()=>[n.state=="Authenticating"?(f(),h(a(M),{key:0,slot:"icon-only"})):(f(),O(U,{key:1},[ca],64))]),_:1},8,["disabled","onClick"])]),_:1})]),_:1}))}});const _a=D({setup(n){const r=B(null),{login:_}=ta(),{replace:u}=W(),p=j({id:"Login",initial:"AwaitingCredentials",states:{AwaitingCredentials:{on:{LOGIN_REQUESTED:{target:"Authenticating",actions:"login"}}},Authenticating:{on:{LOGIN_SUCCEEDED:{target:"AwaitingCredentials",actions:"enterWiki"},LOGIN_FAILED:{target:"AwaitingCredentials",actions:"toastFailure"}}}}},{actions:{toastFailure:()=>sa({message:"Deine Anmeldung ist fehlgeschlagen.",color:"danger"}),enterWiki:()=>u({name:"MangaListPage"}),login:async(s,l)=>{try{await _(l),d("LOGIN_SUCCEEDED")}catch{d("LOGIN_FAILED")}}}}),{state:i,send:d}=oa(p,{devTools:!1}),g=q(()=>i.value.value);return Q(()=>{var s;return(s=r.value)==null?void 0:s.clear()}),(s,l)=>(f(),h(a($),null,{default:t(()=>[e(a(z),null,{default:t(()=>[e(a(J),{class:"h-full"},{default:t(()=>[e(a(K),{class:"h-full"},{default:t(()=>[e(a(H),{class:"align-top md:flex md:align-middle"},{default:t(()=>[e(fa,{ref_key:"form",ref:r,state:a(g),onSubmit:l[0]||(l[0]=m=>a(d)("LOGIN_REQUESTED",m))},null,8,["state"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});var Ca=la(_a,[["__scopeId","data-v-14913ccb"]]);export{Ca as default};
