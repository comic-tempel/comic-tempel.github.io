var E=Object.defineProperty,L=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var y=(s,t,a)=>t in s?E(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,I=(s,t)=>{for(var a in t||(t={}))z.call(t,a)&&y(s,a,t[a]);if(k)for(var a of k(t))F.call(t,a)&&y(s,a,t[a]);return s},w=(s,t)=>L(s,U(t));import{_ as $,a as q}from"./WikiImg.6622f6d0.js";import{an as H,y as g,z as R,q as j,d as A,au as G,x as J,c as h,w as o,u as e,a as l,F as x,A as S,a3 as Q,Q as C,t as f,C as b,ak as B,D as N,g as T,N as D,p as c,av as K,k as P,v as O,G as W,M as X,L as Y,h as Z,i as ee,o as _,a6 as ae,J as te,al as le,am as oe}from"./index.462cec1b.js";import{e as se}from"./mangas.677aea0e.js";import{T as re}from"./TransitionToggleSlideDown.b4043cd0.js";import{n as M}from"./index.1d46ca08.js";import{_ as ne}from"./plugin-vue_export-helper.21dcd24c.js";const{client:ce}=j(),ue=s=>{const t=H({name:null,publisherName:"",coverUrl:"",contributors:[],keywords:[]}),a=g([]),m=async v=>{var p;const{data:u,error:i}=await ce.from("mangas").select("*,user_vlb_library(*)").eq("collection_id",v).order("date_published",{ascending:!1});if(i)throw Error(i.message);u!=null&&u.length>0&&(u.forEach(r=>{let n;r.user_vlb_library.length>0&&(n=r.user_vlb_library[0].shelf),a.value.push(w(I({},se(r)),{shelf:n}))}),t.name=u[0].collection_name,t.publisherName=u[0].publisher_name,t.coverUrl=(p=a.value.map(r=>r.cover("m")).find(r=>r!=null))!=null?p:"",t.keywords=[...new Set(a.value.flatMap(({keywords:r})=>r))],t.contributors=[...new Set(a.value.flatMap(({contributors:r})=>r==null?void 0:r.map(({name:n})=>n)))])};return R(()=>m(s.value)),{mangas:a,collection:t}};const V=s=>(le("data-v-46b24375"),s=s(),oe(),s),ie={class:"h-80"},de=V(()=>c("div",{class:"header-foreground absolute top-0 w-full h-full p-4"},null,-1)),fe={key:0,class:"p-4 flex flex-row gap-4"},_e=V(()=>c("div",{class:"opacity-30"},[c("img",{class:"w-full",src:q})],-1)),pe={class:"basis-2/3"},be={class:"text-2xl py-4"},me={class:"text-lg pb-2"},ve=A({props:{id:null},setup(s){const t=s,{collection:a,mangas:m}=ue(G(t,"id")),{push:v}=J(),u=g(!1),i=g(0),p=r=>{const n=r.detail.scrollTop;n<0||Math.abs(n-i.value)<60||(u.value=n>i.value,i.value=n)};return(r,n)=>(_(),h(e(ee),null,{default:o(()=>[l(re,null,{default:o(()=>[u.value?(_(),h(e(x),{key:0,class:"absolute",translucent:!0},{default:o(()=>[l(e(S),null,{default:o(()=>[l(e(Q),null,{default:o(()=>[C(f(e(a).name),1)]),_:1}),l(e(b),{slot:"start"},{default:o(()=>[l(e(B),{"default-href":"/",text:""})]),_:1}),l(e(b),{slot:"end"},{default:o(()=>[l(e(N),{disabled:""},{default:o(()=>[l(e(T),{slot:"icon-only",src:e(M)},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0)]),_:1}),l(e(Z),{fullscreen:!0,"scroll-events":!0,onIonScroll:n[0]||(n[0]=d=>p(d))},{default:o(()=>[c("div",ie,[c("div",{class:"header-background h-full",style:K(`background-image: url(${e(a).coverUrl})`)},null,4),de,l(e(x),{class:"ion-no-border absolute top-0 overflow-hidden"},{default:o(()=>[l(e(S),{class:"transparent"},{default:o(()=>[l(e(b),{slot:"start"},{default:o(()=>[l(e(B),{"default-href":"/",text:""})]),_:1}),l(e(b),{slot:"end"},{default:o(()=>[l(e(N),{disabled:""},{default:o(()=>[l(e(T),{slot:"icon-only",src:e(M)},null,8,["src"])]),_:1})]),_:1})]),_:1}),e(a).name!=null?(_(),P("div",fe,[l(e(O),{class:"manga-card max-h-56 w-40"},{default:o(()=>[l($,{src:e(a).coverUrl},{default:o(()=>[_e]),_:1},8,["src"])]),_:1}),c("div",pe,[c("p",be,f(e(a).name),1),c("p",me,f(e(a).contributors.join(", ")),1),c("p",null,f(e(a).publisherName),1)])])):D("",!0)]),_:1})]),l(e(W),{lines:"full"},{default:o(()=>[(_(!0),P(Y,null,X(e(m),d=>(_(),h(e(ae),{key:d.gtin13,button:!0,detail:!0,onClick:he=>{e(v)({name:"MangaDetailsPage",params:{gtin13:d.gtin13}})}},{default:o(()=>[l(e(te),null,{default:o(()=>[C(f(d.title),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})]),_:1}))}});var Ce=ne(ve,[["__scopeId","data-v-46b24375"]]);export{Ce as default};
