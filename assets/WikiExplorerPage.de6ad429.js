import{_ as H,p as j,B as q,a as W,b as A}from"./CenteredMessage.370ce273.js";import{d as S,j as G,o as s,k as u,a,w as t,u as e,l as Q,m as P,n as b,t as J,p as T,c as _,q as I,r as K,s as O,v as Z,x as v,y as $,z as X,A as ee,B as ae,C as te,g as se,D as le,E as ne,F as oe,G as z,H as D,J as x,K as k,L,M as re,N as Y,h as ce,i as ue,O as F,P as ie,Q as E}from"./index.bcf5d536.js";import{e as de}from"./mangas.8bd26fa4.js";import{b as _e}from"./index.ec2db92e.js";import{d as N}from"./dayjs.min.090b9f31.js";import{_ as fe}from"./plugin-vue_export-helper.21dcd24c.js";const me={class:"w-20 line-clamp-1 text-sm text-center pt-2"},he=S({props:{collectionId:null,collectionCoverUrl:null,collectionName:null},setup(g){const y=g,{proxyUrlFor:m}=T(),w=G(()=>y.collectionCoverUrl?m(y.collectionCoverUrl):"");return(B,i)=>(s(),u("div",null,[a(e(P),{class:"shadow w-20 h-20"},{default:t(()=>[a(H,{src:e(w)},{default:t(()=>[a(e(Q),{class:"opacity-30 w-full",src:e(j)},null,8,["src"])]),_:1},8,["src"])]),_:1}),b("div",me,J(g.collectionName),1)]))}}),pe={class:"h-36 sm:h-40 lg:h-52 xl:h-64 overflow-clip"},ve={class:"text-sm"},xe=S({setup(g){return(y,m)=>(s(),_(e(O),{class:"manga-card"},{default:t(()=>[b("div",pe,[a(e(I),{class:"m-0",animated:""})]),a(e(K),null,{default:t(()=>[b("div",ve,[a(e(I),{animated:""})])]),_:1})]),_:1}))}}),ge={class:"w-20 text-sm text-center pt-2"},ye=S({setup(g){return(y,m)=>(s(),u("div",null,[a(e(P),{class:"shadow w-20 h-20"},{default:t(()=>[a(e(I),{class:"m-0",animated:""})]),_:1}),b("div",ge,[a(e(I),{animated:""})])]))}});const be=F("Serien"),ke={class:"flex overflow-x-auto overflow-y-clip space-x-4 pb-6 pt-4 px-4 snap-x scrollbar-hide"},Ie=F("Mangas"),Se=S({setup(g){const{client:m}=T(),{push:w}=Z(),B=v(),i=v(null),f=v(null),h=v(""),M=v(!0),C=v(0);$(async()=>{const o=m.from("collection_updates").select();let l=!1;setTimeout(()=>{l||(f.value=null)},200),h.value!=""?o.textSearch("collection_name",h.value,{type:"phrase"}):o.lte("date_published",N().format("YYYY-MM-DD"));const{data:r,error:c}=await o.range(0,20).order("date_published",{ascending:!1});if(c)f.value=[],console.error(c.message);else if(r!=null){const d=[];r.forEach(p=>d.push(p)),f.value=d}l=!0}),$(async()=>{const o=m.from("mangas").select();let l=!1;setTimeout(()=>{l||(i.value=null)},200),h.value!=""?o.textSearch("title_tsv",h.value,{type:"phrase"}):o.lte("date_published",N().format("YYYY-MM-DD"));const{data:r,error:c}=await o.range(0,20).order("date_published",{ascending:!1});if(c)i.value=[],console.error(c.message);else if(r!=null){const d=[];r.forEach(p=>d.push(de(p))),i.value=d}l=!0});const U=o=>{const l=o.detail.scrollTop;l<0||Math.abs(l-C.value)<60||(M.value=l<C.value,C.value=l)},V=async o=>{await w({name:"MangaDetailsPage",params:{gtin13:o}}),ie.dismiss()};return(o,l)=>(s(),_(e(ue),null,{default:t(()=>[a(e(ne),{translucent:!0,class:le(["ion-no-border",{"header-hidden":!M.value}])},{default:t(()=>[a(e(X),{class:"search-toolbar"},{default:t(()=>[a(e(ee),{ref:"searchBar",value:h.value,placeholder:"Mangas und Serien suchen...",onIonChange:l[0]||(l[0]=r=>{var c;return h.value=(c=r.detail.value)!=null?c:""})},null,8,["value"]),a(e(ae),{class:"mr-2",slot:"end"},{default:t(()=>[a(e(te),{id:"scan-button",fill:"solid",color:"primary"},{default:t(()=>[a(e(se),{slot:"icon-only",src:e(_e)},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1},8,["class"]),a(e(ce),{fullscreen:!0,"scroll-events":!0,onIonScroll:l[1]||(l[1]=r=>U(r))},{default:t(()=>{var r,c;return[a(q,{ref_key:"barcodeScanner",ref:B,trigger:"scan-button",onScanned:V},null,512),((r=f.value)==null?void 0:r.length)!=0||((c=i.value)==null?void 0:c.length)!=0?(s(),_(e(oe),{key:0},{default:t(()=>{var d,p;return[((d=f.value)==null?void 0:d.length)!=0?(s(),u(x,{key:0},[a(e(z),null,{default:t(()=>[a(e(D),{class:"text-xl mt-2"},{default:t(()=>[be]),_:1})]),_:1}),b("div",ke,[f.value==null?(s(!0),u(x,{key:0},k(20+1,n=>(s(),u("div",{class:"flex-shrink-0 snap-center",key:n},[a(ye)]))),128)):(s(!0),u(x,{key:1},k(f.value,n=>(s(),u("div",{class:"flex-shrink-0 snap-center",key:n.collection_id},[a(he,{"collection-id":n.collection_id,"collection-cover-url":n.cover,"collection-name":n.collection_name},null,8,["collection-id","collection-cover-url","collection-name"])]))),128))])],64)):L("",!0),((p=i.value)==null?void 0:p.length)!=0?(s(),u(x,{key:1},[a(e(z),null,{default:t(()=>[a(e(D),{class:"text-xl mt-2"},{default:t(()=>[Ie]),_:1})]),_:1}),a(e(re),null,{default:t(()=>[i.value==null?(s(),_(e(Y),{key:0},{default:t(()=>[(s(!0),u(x,null,k(20+1,n=>(s(),_(e(E),{key:n,"size-lg":"2","size-md":"3","size-sm":"4","size-xs":"4"},{default:t(()=>[a(xe)]),_:2},1024))),128))]),_:1})):(s(),_(e(Y),{key:1},{default:t(()=>[(s(!0),u(x,null,k(i.value,n=>(s(),_(e(E),{key:n.gtin13,"size-lg":"2","size-md":"3","size-sm":"4","size-xs":"4"},{default:t(()=>{var R;return[a(A,{title:n.title,"cover-url":(R=n.cover("m"))!=null?R:"","router-link":`/manga/${n.gtin13}`},null,8,["title","cover-url","router-link"])]}),_:2},1024))),128))]),_:1}))]),_:1})],64)):L("",!0)]}),_:1})):(s(),_(W,{key:1,emoji:"\u{1F914}",text:"Weder Serien noch Mangas gefunden"}))]}),_:1})]),_:1}))}});var ze=fe(Se,[["__scopeId","data-v-7b0cbf86"]]);export{ze as default};
