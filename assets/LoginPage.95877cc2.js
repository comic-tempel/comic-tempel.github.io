import{d as S,n as I,o as m,c as v,w as t,a,u as e,a7 as M,a8 as D,a9 as F,J as K,k as y,aa as C,j as b,a3 as k,ab as A,ac as x,a2 as E,b as o,t as V,f as N,ad as R,x as T,ae as B,af as P,y as j,F as U,m as W,Y as z,l as G,X as $,ag as q,M as O,z as Q,ah as H,ai as J,aj as X}from"./index.2105b4e5.js";import{u as Y,t as Z,o as ee,e as ae,p as te,a as L}from"./validation.eb119200.js";import{t as se}from"./ui.48eab65e.js";import{_ as ne}from"./plugin-vue_export-helper.21dcd24c.js";import{c as oe,u as le}from"./useMachine.3c0cc271.js";var ie="/assets/header.d375a6b9.jpg";const de=j("img",{class:"w-full",src:ie,alt:"Manga Wiki Kopzeile"},null,-1),re=o("Manga Wiki"),ue=o("Anmeldung "),ce=o("E-Mail Adresse"),me=o("Passwort"),fe=o("anmelden"),pe=S({props:{email:{default:void 0},password:{default:void 0},state:{default:"AwaitingCredentials"}},emits:["submit"],setup(l,{expose:r,emit:f}){const u=l,{handleSubmit:p,errors:i,meta:g,resetForm:_}=Y({validationSchema:Z(ee({email:ae,password:te}))}),{value:s}=L("email"),{value:n}=L("password"),d=p(w=>f("submit",w));return I(()=>s.value=u.email),I(()=>n.value=u.password),r({reset:_}),(w,c)=>(m(),v(e(P),{class:"rounded-none shadow-none m-auto w-full md:w-96 md:rounded-xl md:shadow-xl"},{default:t(()=>[de,a(e(F),null,{default:t(()=>[a(e(M),null,{default:t(()=>[re]),_:1}),a(e(D),null,{default:t(()=>[ue]),_:1})]),_:1}),a(e(B),null,{default:t(()=>[a(e(K),{class:"m-0",lines:"full"},{default:t(()=>[a(e(y),{class:C({"ion-invalid":e(i).email})},{default:t(()=>[a(e(b),{position:"floating"},{default:t(()=>[ce]),_:1}),a(e(k),{modelValue:e(s),"onUpdate:modelValue":c[0]||(c[0]=h=>A(s)?s.value=h:null),name:"email",type:"email",autocomplete:"email",inputmode:"email",required:"true",enterkeyhint:"next",autofocus:!0,disabled:l.state=="Authenticating",onKeyup:x(e(d),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(E),{slot:"error"},{default:t(()=>[o(V(e(i).email),1)]),_:1})]),_:1},8,["class"]),a(e(y),{class:C({"ion-invalid":e(i).password})},{default:t(()=>[a(e(b),{position:"floating"},{default:t(()=>[me]),_:1}),a(e(k),{modelValue:e(n),"onUpdate:modelValue":c[1]||(c[1]=h=>A(n)?n.value=h:null),name:"password",type:"password",required:"true",enterkeyhint:"send",disabled:l.state=="Authenticating",onKeyup:x(e(d),["enter"])},null,8,["modelValue","disabled","onKeyup"]),a(e(E),{slot:"error"},{default:t(()=>[o(V(e(i).password),1)]),_:1})]),_:1},8,["class"])]),_:1}),a(e(N),{class:"mt-5",expand:"full",disabled:!e(g).valid||l.state=="Authenticating",onClick:e(d)},{default:t(()=>[l.state=="Authenticating"?(m(),v(e(R),{key:0,slot:"icon-only"})):(m(),T(U,{key:1},[fe],64))]),_:1},8,["disabled","onClick"])]),_:1})]),_:1}))}});const ge=S({setup(l){const r=W(null),{login:f}=z(),{replace:u}=G(),p=oe({id:"Login",initial:"AwaitingCredentials",schema:{events:{}},states:{AwaitingCredentials:{on:{LOGIN_REQUESTED:{target:"Authenticating"}}},Authenticating:{invoke:{src:"authenticate",onDone:"Authenticated",onError:{actions:"showError",target:"AwaitingCredentials"}}},Authenticated:{type:"final",entry:"enterWiki"}}},{actions:{showError:()=>se({message:"Deine Anmeldung ist fehlgeschlagen.",color:"danger"}),enterWiki:()=>u({name:"MangaListPage"})},services:{authenticate:(s,n)=>f(n)}}),{state:i,send:g}=le(p,{devTools:!1}),_=$(()=>i.value.value);return q(()=>{var s;return(s=r.value)==null?void 0:s.reset()}),(s,n)=>(m(),v(e(O),null,{default:t(()=>[a(e(Q),null,{default:t(()=>[a(e(X),{class:"h-full"},{default:t(()=>[a(e(H),{class:"h-full"},{default:t(()=>[a(e(J),{class:"align-top md:flex md:align-middle"},{default:t(()=>[a(pe,{ref_key:"form",ref:r,state:e(_),onSubmit:n[0]||(n[0]=d=>e(g)("LOGIN_REQUESTED",d))},null,8,["state"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});var ye=ne(ge,[["__scopeId","data-v-786342c2"]]);export{ye as default};
