import{d as E,o as R,c as I,w as L,a as k,u as h,I as O,b,e as S,r as f,f as T,g as x,h as A,i as W,n as N,j as C,k as M,l as U}from"./vendor.b36a9285.js";const D=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerpolicy&&(a.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?a.credentials="include":t.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(t){if(t.ep)return;t.ep=!0;const a=n(t);fetch(t.href,a)}};D();const V=E({setup(e){return(r,n)=>(R(),I(h(b),null,{default:L(()=>[k(h(O))]),_:1}))}}),$="modulepreload",g={},j="/",u=function(r,n){return!n||n.length===0?r():Promise.all(n.map(o=>{if(o=`${j}${o}`,o in g)return;g[o]=!0;const t=o.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${a}`))return;const s=document.createElement("link");if(s.rel=t?"stylesheet":$,t||(s.as="script",s.crossOrigin=""),s.href=o,document.head.appendChild(s),t)return new Promise((c,p)=>{s.addEventListener("load",c),s.addEventListener("error",p)})})).then(()=>r())},q="https://lkkhutelhlzqipepirdc.supabase.co",B="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyNjc1OTk3MSwiZXhwIjoxOTQyMzM1OTcxfQ.zw0Ndon-xhxiSvBvWLSf8ePP5vXesxTLx_moX9bM6rk",J="manga-wiki-media.sit.institute",X=S(q,B,{detectSessionInUrl:!0,autoRefreshToken:!0,persistSession:!0}),z=(e,r)=>{const n=e.replace("api.vlb.de",J);return r===void 0?n:n.replace(/\/(s|m|l)$/,`/${r=="xl"?"":r}`)},F=()=>({client:X,proxyUrlFor:z}),{client:l}=F(),d=f(l.auth.user()),y=f([]),K=async e=>{const{data:r,error:n}=await l.auth.update({password:e});if(r!=null)d.value=r;else throw console.error(n!=null?n:"unknown Error"),Error()},G=async e=>{var o,t;if(e==null&&d.value==null)throw console.error("neither email not current user available"),new Error;const{data:r,error:n}=await l.auth.api.resetPasswordForEmail((t=e!=null?e:(o=d.value)==null?void 0:o.email)!=null?t:"");if(r==null)throw console.error(n!=null?n:"unknown Error"),Error()},H=async e=>{const{error:r}=await l.auth.signIn(e);if(r!=null)throw console.error(r!=null?r:"unknown Error"),Error()},Q=async()=>l.auth.signOut(),Y=e=>y.value.includes(e);l.auth.onAuthStateChange(async()=>{var n,o;d.value=l.auth.user(),console.log((n=d.value)==null?void 0:n.email);const{data:e,error:r}=await l.from("user_permissions").select("permissions").single();y.value=(o=e==null?void 0:e.permissions)!=null?o:[],r&&console.error(r)});const Z=()=>({currentUser:T(d),hasPermission:Y,requestPasswordReset:G,updatePasswort:K,login:H,logout:Q}),{currentUser:v}=Z(),m=x({history:A("/"),routes:[{path:"/",redirect:e=>/type=(recovery|invite)/.test(e.hash)&&e.name!="PasswordRecoveryPage"?{name:"PasswordRecoveryPage",hash:e.hash}:{name:"MangaListPage"}},{path:"/mangas",name:"MangaListPage",component:()=>u(()=>import("./MangaListPage.0a3ebe84.js"),["assets/MangaListPage.0a3ebe84.js","assets/vendor.b36a9285.js","assets/mangas.d23becbe.js","assets/useMachine.8dc68ed1.js"])},{path:"/manga/:gtin13",name:"MangaDetailsPage",component:()=>u(()=>import("./MangaDetailsPage.22b1b6f4.js"),["assets/MangaDetailsPage.22b1b6f4.js","assets/vendor.b36a9285.js","assets/mangas.d23becbe.js","assets/plugin-vue_export-helper.50b60037.js"]),props:e=>({gtin13:Number.parseInt(e.params.gtin13)})},{path:"/login",name:"LoginPage",component:()=>u(()=>import("./LoginPage.ca6989bb.js"),["assets/LoginPage.ca6989bb.js","assets/vendor.b36a9285.js","assets/validation.826330e0.js","assets/plugin-vue_export-helper.50b60037.js","assets/useMachine.8dc68ed1.js"])},{path:"/profile",name:"ProfilePage",component:()=>u(()=>import("./ProfilePage.569c4236.js"),["assets/ProfilePage.569c4236.js","assets/vendor.b36a9285.js"])},{path:"/profile/password",name:"PasswordResetPage",component:()=>u(()=>import("./PasswordResetPage.c5318ceb.js"),["assets/PasswordResetPage.c5318ceb.js","assets/vendor.b36a9285.js","assets/useMachine.8dc68ed1.js"])},{path:"/profile/password/recovery",name:"PasswordRecoveryPage",component:()=>u(()=>import("./PasswordRecoveryPage.9c70d34b.js"),["assets/PasswordRecoveryPage.9c70d34b.js","assets/vendor.b36a9285.js","assets/validation.826330e0.js","assets/useMachine.8dc68ed1.js"])}]});m.beforeEach(e=>{if(v.value==null&&e.name!="LoginPage"&&e.name!="PasswordRecoveryPage")return{name:"LoginPage"};if(v.value!=null&&e.name=="LoginPage")return{name:"MangaListPage"}});function ee(e={}){const{immediate:r=!1,onNeedRefresh:n,onOfflineReady:o,onRegistered:t,onRegisterError:a}=e;let s,c;const p=async(i=!0)=>{i&&(s==null||s.addEventListener("controlling",P=>{P.isUpdate&&window.location.reload()})),c&&c.waiting&&await N(c.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){s=new W("/sw.js",{scope:"/",type:"classic"}),s.addEventListener("activated",i=>{i.isUpdate||o==null||o()});{const i=()=>{n==null||n()};s.addEventListener("waiting",i),s.addEventListener("externalwaiting",i)}s.register({immediate:r}).then(i=>{c=i,t==null||t(i)}).catch(i=>{a==null||a(i)})}return p}function re(e={}){const{immediate:r=!0,onNeedRefresh:n,onOfflineReady:o,onRegistered:t,onRegisterError:a}=e,s=f(!1),c=f(!1);return{updateServiceWorker:ee({immediate:r,onNeedRefresh(){s.value=!0,n==null||n()},onOfflineReady(){c.value=!0,o==null||o()},onRegistered:t,onRegisterError:a}),offlineReady:c,needRefresh:s}}"serviceWorker"in navigator&&re();const te=C(V).use(M).use(m),w=window.matchMedia("(prefers-color-scheme: dark)"),_=e=>{document.body.classList.toggle("dark",e)};_(w.matches);w.addListener(e=>_(e.matches));m.isReady().then(()=>{te.mount("#app"),U()});console.log=()=>{},console.error=()=>{},console.warn=()=>{};export{Z as a,F as u};
