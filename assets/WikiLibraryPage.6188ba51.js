import{B as I,_ as h}from"./BarcodeScannerModal.951a25e3.js";import{d as v,r as k,j as B,k as w,c as d,w as t,u as e,a as r,l as x,m as f,n as m,g as _,p as E,q as T,s as z,t as L,v as C,x as F,y as S,F as M,h as A,i as D,z as N,A as P,o as u,B as R}from"./index.2d6df163.js";import{e as V}from"./mangas.e5277e7d.js";import{t as p,a as $}from"./ui.a8e2d16f.js";import{p as j,a as q}from"./index.50a34d4d.js";import"./plugin-vue_export-helper.21dcd24c.js";const G=N("Meine Sammlung"),X=v({setup(H){const{client:i}=P(),n=k([]),{beforeEach:g}=B(),{currentUser:b}=w(),l=async()=>{const{data:s,error:o}=await i.from("mangas").select("*, user_vlb_library!inner(*)");if(s!=null)n.value=s.map(V);else throw o?(p(),Error(o.message)):Error("There is no data...")},y=async s=>{var o;if(n.value.every(a=>a.gtin13!=s)){const{error:a}=await i.from("user_vlb_library").insert({gtin13:s,user_id:(o=b.value)==null?void 0:o.id});if(a)throw p(),Error(a.message);l()}else $({message:"Dieser Manga ist bereits Teil Deiner Sammlung \u{1F389}",color:"success",duration:3e3})};return g(s=>(s.name=="WikiLibraryPage"&&l(),!0)),l(),(s,o)=>(u(),d(e(D),null,{default:t(()=>[r(e(T),{class:"ion-no-border",translucent:!0},{default:t(()=>[r(e(x),null,{default:t(()=>[r(e(f),{slot:"start"},{default:t(()=>[r(e(m),{"router-link":"/profile"},{default:t(()=>[r(e(_),{slot:"icon-only",src:e(j)},null,8,["src"])]),_:1})]),_:1}),r(e(E),null,{default:t(()=>[G]),_:1}),r(e(f),{slot:"end"},{default:t(()=>[r(e(m),{id:"add-button"},{default:t(()=>[r(e(_),{slot:"icon-only",src:e(q)},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1}),r(e(A),null,{default:t(()=>[r(I,{trigger:"add-button",onScanned:y}),r(e(z),{lines:"full"},{default:t(()=>[r(e(L),null,{default:t(()=>[r(e(C),null,{default:t(()=>[(u(!0),F(M,null,S(n.value,a=>(u(),d(e(R),{key:a.gtin13,"size-lg":"2","size-md":"3","size-sm":"4","size-xs":"4"},{default:t(()=>{var c;return[r(h,{title:a.title,"cover-url":(c=a.cover("m"))!=null?c:"","router-link":`/manga/${a.gtin13}`},null,8,["title","cover-url","router-link"])]}),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{X as default};
