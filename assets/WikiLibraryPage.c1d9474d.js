import{B as k,_ as B}from"./BarcodeScannerModal.6a3c5e1d.js";import{d as w,r as x,j as z,k as F,c as f,w as r,u as e,a as t,l as T,m,n as _,g,p as C,q as E,s as L,t as S,v as $,x as A,y as M,F as N,h as P,i as R,z as V,A as j,o as c,B as q}from"./index.d085fc6e.js";import{e as D}from"./mangas.3f4ee5db.js";import{t as p,a as b}from"./ui.06568f15.js";import{p as G,a as H}from"./index.50a34d4d.js";import"./plugin-vue_export-helper.21dcd24c.js";const U=V("Meine Sammlung"),Z=w({setup(W){const{client:d}=j(),l=x([]),{beforeEach:I}=z(),{currentUser:v}=F(),i=async()=>{const{data:s,error:n}=await d.from("mangas").select("*, user_vlb_library!inner(*)");if(s!=null)l.value=s.map(D);else throw n?(p(),Error(n.message)):Error("There is no data...")},y=async s=>{var a;const n=l.value.find(o=>o.gtin13==s);if(n!==void 0)b({message:`"${n.title}" ist bereits Teil Deiner Sammlung \u{1F914}`,color:"success",duration:3e3});else{const{error:o}=await d.from("user_vlb_library").insert({gtin13:s,user_id:(a=v.value)==null?void 0:a.id});if(o)p(),console.error(o.message);else{await i();const u=l.value.find(h=>h.gtin13==s);b({message:`"${u==null?void 0:u.title}" hinzugef\xFCgt \u{1F389}`,color:"success",duration:3e3})}}};return I(s=>(s.name=="WikiLibraryPage"&&i(),!0)),i(),(s,n)=>(c(),f(e(R),null,{default:r(()=>[t(e(E),{class:"ion-no-border",translucent:!0},{default:r(()=>[t(e(T),null,{default:r(()=>[t(e(m),{slot:"start"},{default:r(()=>[t(e(_),{"router-link":"/profile"},{default:r(()=>[t(e(g),{slot:"icon-only",src:e(G)},null,8,["src"])]),_:1})]),_:1}),t(e(C),null,{default:r(()=>[U]),_:1}),t(e(m),{slot:"end"},{default:r(()=>[t(e(_),{id:"add-button"},{default:r(()=>[t(e(g),{slot:"icon-only",src:e(H)},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1}),t(e(P),null,{default:r(()=>[t(k,{trigger:"add-button",onScanned:y}),t(e(L),{lines:"full"},{default:r(()=>[t(e(S),null,{default:r(()=>[t(e($),null,{default:r(()=>[(c(!0),A(N,null,M(l.value,a=>(c(),f(e(q),{key:a.gtin13,"size-lg":"2","size-md":"3","size-sm":"4","size-xs":"4"},{default:r(()=>{var o;return[t(B,{title:a.title,"cover-url":(o=a.cover("m"))!=null?o:"","router-link":`/manga/${a.gtin13}`},null,8,["title","cover-url","router-link"])]}),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{Z as default};
