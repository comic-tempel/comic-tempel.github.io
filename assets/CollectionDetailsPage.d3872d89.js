var z=Object.defineProperty,U=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var I=(o,n,a)=>n in o?z(o,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[n]=a,w=(o,n)=>{for(var a in n||(n={}))F.call(n,a)&&I(o,a,n[a]);if(y)for(var a of y(n))H.call(n,a)&&I(o,a,n[a]);return o},x=(o,n)=>U(o,q(n));import{_ as L,a as R}from"./WikiImg.6145a022.js";import{y as $,an as A,z as k,A as j,q as G,d as K,av as O,x as J,c as g,w as l,u as e,a as s,G as S,B as C,a3 as Q,R as B,t as p,D as m,ak as N,E as P,g as T,O as D,p as c,aw as W,k as E,v as X,H as Y,N as Z,M as ee,h as ae,i as te,o as b,a6 as se,F as le,K as oe,al as ne,am as re}from"./index.6b623a37.js";import{e as ce}from"./mangas.0c57203a.js";import{T as ie}from"./TransitionToggleSlideDown.51f6b796.js";import{n as M}from"./index.1a1d4649.js";import{_ as ue}from"./plugin-vue_export-helper.21dcd24c.js";const{client:de}=G(),fe=o=>{const{hasPermission:n}=$(),a=A({name:null,publisherName:"",coverUrl:"",contributors:[],keywords:[]}),i=k([]),h=async v=>{var r;const d=de.from("mangas").select("*,user_vlb_library(*)");n("contribution.change_visibility")||d.is("is_visible",!0);const{data:u,error:f}=await d.eq("collection_id",v).order("date_published",{ascending:!1});if(f)throw Error(f.message);u!=null&&u.length>0&&(u.forEach(t=>{let _;t.user_vlb_library.length>0&&(_=t.user_vlb_library[0].shelf),i.value.push(x(w({},ce(t)),{shelf:_}))}),a.name=u[0].collection_name,a.publisherName=u[0].publisher_name,a.coverUrl=(r=i.value.map(t=>t.cover("m")).find(t=>t!=null))!=null?r:"",a.keywords=[...new Set(i.value.flatMap(({keywords:t})=>t))],a.contributors=[...new Set(i.value.flatMap(({contributors:t})=>t==null?void 0:t.map(({name:_})=>_)))])};return j(()=>h(o.value)),{mangas:i,collection:a}};const V=o=>(ne("data-v-1a9c1ccb"),o=o(),re(),o),_e={class:"h-80"},pe=V(()=>c("div",{class:"header-foreground absolute top-0 w-full h-full p-4"},null,-1)),be={key:0,class:"p-4 flex flex-row gap-4"},ve=V(()=>c("div",{class:"opacity-30"},[c("img",{class:"w-full",src:R})],-1)),me={class:"basis-2/3"},he={class:"text-2xl py-4"},ge={class:"text-lg pb-2"},ke=K({props:{id:null},setup(o){const n=o,{collection:a,mangas:i}=fe(O(n,"id")),{push:h}=J(),v=k(!1),d=k(0),u=f=>{const r=f.detail.scrollTop;r<0||Math.abs(r-d.value)<60||(v.value=r>d.value,d.value=r)};return(f,r)=>(b(),g(e(te),null,{default:l(()=>[s(ie,null,{default:l(()=>[v.value?(b(),g(e(S),{key:0,class:"absolute",translucent:!0},{default:l(()=>[s(e(C),null,{default:l(()=>[s(e(Q),null,{default:l(()=>[B(p(e(a).name),1)]),_:1}),s(e(m),{slot:"start"},{default:l(()=>[s(e(N),{"default-href":"/",text:""})]),_:1}),s(e(m),{slot:"end"},{default:l(()=>[s(e(P),{disabled:""},{default:l(()=>[s(e(T),{slot:"icon-only",src:e(M)},null,8,["src"])]),_:1})]),_:1})]),_:1})]),_:1})):D("",!0)]),_:1}),s(e(ae),{fullscreen:!0,"scroll-events":!0,onIonScroll:r[0]||(r[0]=t=>u(t))},{default:l(()=>[c("div",_e,[c("div",{class:"header-background h-full",style:W(`background-image: url(${e(a).coverUrl})`)},null,4),pe,s(e(S),{class:"ion-no-border absolute top-0 overflow-hidden"},{default:l(()=>[s(e(C),{class:"transparent"},{default:l(()=>[s(e(m),{slot:"start"},{default:l(()=>[s(e(N),{"default-href":"/",text:""})]),_:1}),s(e(m),{slot:"end"},{default:l(()=>[s(e(P),{disabled:""},{default:l(()=>[s(e(T),{slot:"icon-only",src:e(M)},null,8,["src"])]),_:1})]),_:1})]),_:1}),e(a).name!=null?(b(),E("div",be,[s(e(X),{class:"manga-card max-h-56 w-40"},{default:l(()=>[s(L,{src:e(a).coverUrl},{default:l(()=>[ve]),_:1},8,["src"])]),_:1}),c("div",me,[c("p",he,p(e(a).name),1),c("p",ge,p(e(a).contributors.join(", ")),1),c("p",null,p(e(a).publisherName),1)])])):D("",!0)]),_:1})]),s(e(Y),{lines:"full"},{default:l(()=>[(b(!0),E(ee,null,Z(e(i),t=>(b(),g(e(se),{class:le({translucent:!t.is_visible}),key:t.gtin13,button:!0,detail:!0,onClick:_=>{e(h)({name:"MangaDetailsPage",params:{gtin13:t.gtin13}})}},{default:l(()=>[s(e(oe),null,{default:l(()=>[B(p(t.title),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1})]),_:1}))}});var Ne=ue(ke,[["__scopeId","data-v-1a9c1ccb"]]);export{Ne as default};
