import{B as x,a as z}from"./BarcodeScannerModal.ae24f775.js";import{d as C,x as E,j as F,v as T,Y as $,c as h,w as t,u as e,a as s,z as L,B as _,C as g,g as p,Z as M,O as N,t as S,E as R,F as P,M as V,N as W,k as j,K as q,J as A,h as D,i as G,p as H,o as f,Q as J}from"./index.1d7060d5.js";import{e as K}from"./mangas.9756f70a.js";import{t as b,a as v}from"./ui.1362af6d.js";import{p as O,a as Q}from"./index.5c4a8140.js";import"./plugin-vue_export-helper.21dcd24c.js";const te=C({props:{shelf:null},setup(i){const n=i,{client:m}=H(),u=E([]),y=F(()=>{switch(n.shelf){case"wished":return"Meine Wunschliste";case"owned":return"Meine Sammlung";default:return n.shelf}}),{beforeEach:I}=T(),{currentUser:w}=$(),c=async()=>{const{data:r,error:o}=await m.from("mangas").select("*, user_vlb_library!inner(*)").eq("user_vlb_library.shelf",n.shelf);if(r!=null)u.value=r.map(K);else throw o?(b(),Error(o.message)):Error("There is no data...")},k=async r=>{var a;const o=u.value.find(l=>l.gtin13==r);if(o!==void 0)v({message:`"${o.title}" ist bereits Teil dieses Regals \u{1F914}`,color:"success",duration:3e3});else{const{error:l}=await m.from("user_vlb_library").upsert({gtin13:r,shelf:n.shelf,user_id:(a=w.value)==null?void 0:a.id});if(l)b(),console.error(l.message);else{await c();const d=u.value.find(B=>B.gtin13==r);v({message:`"${d==null?void 0:d.title}" hinzugef\xFCgt \u{1F389}`,color:"success",duration:3e3})}}};return I(r=>(r.name=="WikiLibraryPage"&&c(),!0)),c(),(r,o)=>(f(),h(e(G),null,{default:t(()=>[s(e(R),{class:"ion-no-border",translucent:!0},{default:t(()=>[s(e(L),null,{default:t(()=>[s(e(_),{slot:"start"},{default:t(()=>[s(e(g),{"router-link":"/profile"},{default:t(()=>[s(e(p),{slot:"icon-only",src:e(O)},null,8,["src"])]),_:1})]),_:1}),s(e(M),null,{default:t(()=>[N(S(e(y)),1)]),_:1}),s(e(_),{slot:"end"},{default:t(()=>[s(e(g),{id:`add-button-${i.shelf}`},{default:t(()=>[s(e(p),{slot:"icon-only",src:e(Q)},null,8,["src"])]),_:1},8,["id"])]),_:1})]),_:1})]),_:1}),s(e(D),null,{default:t(()=>[s(x,{trigger:`add-button-${i.shelf}`,onScanned:k},null,8,["trigger"]),s(e(P),{lines:"full"},{default:t(()=>[s(e(V),null,{default:t(()=>[s(e(W),null,{default:t(()=>[(f(!0),j(A,null,q(u.value,a=>(f(),h(e(J),{key:a.gtin13,"size-lg":"2","size-md":"3","size-sm":"4","size-xs":"4"},{default:t(()=>{var l;return[s(z,{title:a.title,"cover-url":(l=a.cover("m"))!=null?l:"","router-link":`/manga/${a.gtin13}`},null,8,["title","cover-url","router-link"])]}),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});export{te as default};
